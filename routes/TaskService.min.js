var BSON=require("mongodb").BSON,ObjectID=require("mongodb").ObjectID;TaskService=function(e){this.db=e},TaskService.prototype.getCollection=function(e){this.db.collection("task",function(t,n){t?e(t):e(null,n)})},TaskService.prototype.findAll=function(e){this.getCollection(function(t,n){t?e(t):n.find().toArray(function(t,n){t?e(t):e(null,n)})})},TaskService.prototype.save=function(e,t){this.getCollection(function(n,i){if(n)t(n);else{"undefined"==typeof e.length&&(e=[e]);for(var o=0;o<e.length;o++)task=e[o],task.created_at=new Date;i.insert(e,function(){t(null,e)})}})},TaskService.prototype.findOne=function(e,t){this.getCollection(function(n,i){n?t(n):i.findOne({id:e},function(e,n){e?t(e):t(null,n)})})},TaskService.prototype.update=function(e,t){this.getCollection(function(n,i){n?t(n):i.update({id:e.id},{$set:{name:e.name,description:e.description}},function(e,n){t(e?e:n)})})},TaskService.prototype.remove=function(e,t){this.getCollection(function(n,i){n?t(n):i.remove({id:e},{justOne:!0},function(e,n){t(n)})})},exports.TaskService=TaskService;
