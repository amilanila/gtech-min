var BSON=require("mongodb").BSON,ObjectID=require("mongodb").ObjectID,fs=require("fs");ManualService=function(n){this.db=n},ManualService.prototype.getCollection=function(n){this.db.collection("manual",function(e,i){e?n(e):n(null,i)})},ManualService.prototype.findAll=function(n){this.getCollection(function(e,i){e?n(e):i.find().toArray(function(e,i){e?n(e):n(null,i)})})},ManualService.prototype.save=function(n,e){this.getCollection(function(i,t){i?e(i):t.insert(n,function(){var i=__dirname+"/../public/uploads/"+n.id;fs.mkdirSync(i,"0777"),fs.writeFileSync(i+"/"+n.filename,n.data),e(null,n)})})},ManualService.prototype.findOne=function(n,e){this.getCollection(function(i,t){i?e(i):t.findOne({id:n},function(n,i){n?e(n):e(null,i)})})},ManualService.prototype.remove=function(n,e){this.getCollection(function(i,t){i?e(i):t.remove({id:n},{justOne:!0},function(i,t){var o=__dirname+"/../public/uploads/"+n;fs.unlinkSync(o),e(t)})})},exports.ManualService=ManualService;
