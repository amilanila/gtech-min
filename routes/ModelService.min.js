var BSON=require("mongodb").BSON,ObjectID=require("mongodb").ObjectID;ModelService=function(e){this.db=e},ModelService.prototype.getCollection=function(e){this.db.collection("model",function(o,t){o?e(o):e(null,t)})},ModelService.prototype.findAll=function(e){this.getCollection(function(o,t){o?e(o):t.find().toArray(function(o,t){o?e(o):e(null,t)})})},ModelService.prototype.save=function(e,o){this.getCollection(function(t,n){if(t)o(t);else{"undefined"==typeof e.length&&(e=[e]);for(var i=0;i<e.length;i++)model=e[i],e.created_at=new Date;n.insert(e,function(){o(null,e)})}})},ModelService.prototype.findOne=function(e,o){this.getCollection(function(t,n){t?o(t):n.findOne({id:e},function(e,t){e?o(e):o(null,t)})})},ModelService.prototype.update=function(e,o){this.getCollection(function(t,n){t?o(t):n.update({id:e.id},{$set:{make:e.make,name:e.name,yom:e.yom,description:e.description}},function(e,t){o(e?e:t)})})},ModelService.prototype.remove=function(e,o){this.getCollection(function(t,n){t?o(t):n.remove({id:e},{justOne:!0},function(e,t){o(t)})})},exports.ModelService=ModelService;
